import{d as J,c as u,r as i,ag as ee,z as te,o as se,b as n,e as t,t as d,f as ae,ah as le,F as p,n as h,j as I,s as ne,g as A,l as B,ai as ie,aj as oe,a as l,k as ce,p as ue,h as de,i as U,_ as re}from"./index.e706543d.js";import{g as ge,C as V,a as ve,f as _e,P as v,N as pe}from"./news.0537a800.js";import{N as C,b as $,u as he}from"./request-cancel-map.b5b1ef66.js";const Ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAICAYAAADN5B7xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgBhVDLDYJAEB02snikBEvQEizBDqzCBBbiemCXeBErMFZArAA7gBK0A48CYcYlxgTBzzvN572ZN2NF0XYKUIMQooAfePEYYuOCxTIp9eQbWWvTY00KYAMLQ+9MSBubgxFJt09uawiQEdFeiFXB2mIQ+AkSnDh30r6Aj8cHRDgGvp8MViulMxXHu46Vtcnfhoy6SVWVC9txcqXUlTFGDdKyLu+zLseCDwcae7kJb3UFcym9C/xDK3q+cYgHfSZQ48cZ348AAAAASUVORK5CYII=",fe="/assets/bg1.83fc98e3.png",me="/assets/bg2.d8499e74.png",Te="/assets/bg3.495286ab.png",we="/assets/bg4.965903e4.png",q=o=>(ue("data-v-23ec8ff9"),o=o(),de(),o),Ce={class:"container"},ye={class:"big-title"},Ee={class:"content"},Le={class:"left"},be={key:0,style:{height:"50px",display:"flex","align-items":"center"}},ke=["onClick"],Ie={class:"news-content"},Be={class:"text-container"},xe={class:"top"},Ne={class:"name"},Se={class:"date"},De={class:"bottom"},He={class:"title"},Ge=["innerHTML"],Me={key:0,class:"tags-container"},Re={class:"tags"},Ye={key:0,class:"tag"},Fe={class:"right"},Qe={class:"title"},Ue=q(()=>t("div",{class:"text"},"Topics",-1)),Ve={class:"clear-container"},$e=q(()=>t("img",{src:Ae},null,-1)),qe=[$e],ze={class:"tags-container"},Ke={class:"tags-box"},We=["onClick"],Xe={key:0,class:"not-tags"},je=J({__name:"index",props:{pageType:{}},setup(o){let{defineCancelMaps:z,saveCancelFn:x,cancelRequest:N,cancelRequests:K}=he();z([C,$]);let S=u(()=>{const s=window.innerWidth>414,a={[v.GameGuide]:s?fe:me,[v.EducationCourses]:s?Te:we};return{title:i({[v.GameGuide]:"Game Guide",[v.EducationCourses]:"Education Courses"}).value[o.pageType],bgImage:a[o.pageType]}}),f=i(!1),m=i([]),D=u(()=>s=>{var a;return(a=m.value.find(e=>e.id===s))==null?void 0:a.name}),H=i(!1),W=u(()=>m.value.length),r=i([]),T=u(()=>r.value.map(s=>s.id)),G=u(()=>s=>T.value.includes(s.id)),y=u(()=>T.value.length),X=u(()=>r.value.map(s=>`# ${s.name}`).join(" , "));function j(s){switch(G.value(s)){case!0:r.value=r.value.filter(a=>a!==s);break;case!1:r.value.push(s);break}}let M=i(null),R=i(!1);ee(()=>T.value,()=>{N(C),_.value=[],g.value.page=1,b()});async function O(){try{H.value=!0;let{cancel:s,request:a}=ge({cid:V[o.pageType]});x($,s);let{list:e}=await a();m.value=e,H.value=!1,await ie(),M.value.clientHeight>100&&(R.value=!0)}catch{}}let _=i([]),Y=u(()=>_.value.slice(0,g.value.page*g.value.limit)),F=u(()=>_.value.length),g=i({page:1,limit:20,total:0}),E=i(!1),L=i(!1);async function b(s=!0){let a={cid:V[o.pageType],flgs:T.value.join(","),...oe(g.value)};try{s&&(E.value=!0),L.value=!0;let{cancel:e,request:c}=ve(a);x(C,e);let{list:k,count:Z}=await c();_.value=[..._.value,...k],g.value.total=Z,E.value=!1}catch{}finally{L.value=!1}}function P(s){let a=s.id;switch(o.pageType){case v.GameGuide:U.push({name:"GameGuideDetails",params:{id:a}});break;case v.EducationCourses:U.push({name:"EducationCoursesDetails",params:{id:a}});break}}let w=i(null);async function Q(s){if(L.value||!w.value)return;let a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=w.value.clientHeight;if(!e)return;let c=w.value.offsetTop,k=document.documentElement.scrollTop;e-(k-c)-a<=0&&(N(C),g.value.page++,b(!1))}return te(()=>{b(),O(),window.addEventListener("scroll",Q)}),se(()=>{K(),window.removeEventListener("scroll",Q)}),(s,a)=>(l(),n("div",{class:"News",style:B({backgroundImage:`url('${S.value.bgImage}')`,paddingBottom:Y.value.length?"calc(3vw + 60px)":"3vw"})},[t("div",Ce,[t("div",ye,d(S.value.title),1),t("div",Ee,[t("div",Le,[ae(t("div",{class:"filter-tag"},d(X.value),513),[[le,y.value]]),E.value?(l(),n("div",be,"Loading...")):(l(),n(p,{key:1},[t("div",{class:h(["list-items",{"not-has-selected-tags":!y.value&&F.value}]),ref_key:"listItemRef",ref:w},[(l(!0),n(p,null,I(Y.value,e=>(l(),n("div",{class:"list-item",onClick:c=>P(e)},[t("div",Ie,[t("div",{class:"picture",style:B({backgroundImage:`url(${e.author.head_img})`})},null,4),t("div",Be,[t("div",xe,[t("div",Ne,d(e.author.name),1),t("div",Se,d(ce(_e)(+e.add_time)),1)]),t("div",De,[t("div",He,d(e.title),1),t("div",{class:"description",innerHTML:e.content.content},null,8,Ge),e.flgs?(l(),n("div",Me,[t("div",Re,[(l(!0),n(p,null,I(e.flgs.split(","),c=>(l(),n(p,null,[D.value(+c)?(l(),n("div",Ye,d(D.value(+c)),1)):A("",!0)],64))),256))])])):A("",!0)])])]),t("div",{class:"news-image",style:B({backgroundImage:`url(${e.image_input[0]})`})},null,4)],8,ke))),256))],2),F.value?A("",!0):(l(),ne(pe,{key:0}))],64))]),t("div",Fe,[t("div",Qe,[Ue,t("div",Ve,[t("div",{class:h(["clear",{"has-selected-tags":y.value}]),onClick:a[0]||(a[0]=e=>r.value=[])}," Clear ",2),R.value?(l(),n("div",{key:0,class:h(["arrow",{expand:f.value}]),onClick:a[1]||(a[1]=e=>f.value=!f.value)},qe,2)):A("",!0)])]),t("div",ze,[t("div",Ke,[t("div",{class:h(["tags",{expand:f.value}]),ref_key:"tagsRef",ref:M},[(l(!0),n(p,null,I(m.value,e=>(l(),n("div",{class:h(["tag",{selected:G.value(e)}]),onClick:c=>j(e)},d(e.name),11,We))),256))],2)]),W.value?A("",!0):(l(),n("div",Xe,"No tags available~"))])])])])],4))}});const Je=re(je,[["__scopeId","data-v-23ec8ff9"]]);export{Je as N};
